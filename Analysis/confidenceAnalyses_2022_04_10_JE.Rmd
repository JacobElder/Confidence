---
title: "R Notebook"
output: html_notebook
---

```{r}
library(lmerTest)
library(ggeffects)
```

```{r}
longDf <- read.csv("/Volumes/GoogleDrive/My Drive/Volumes/Research Project/Metacognition/Study 1/input/confClean.csv")
```



```{r}
longDf$evalMid <- abs(4-longDf$eval)
```

# Centrality Predicts Confidence

```{r}
m<-lmer(scale(confidence) ~ scale(outDegree)+ ( scale(outDegree) | subID ) + ( 1 | traits), data=longDf)
summary(m)

m<-lmer(scale(confidence) ~ scale(outDegree)*valence + ( scale(outDegree)*valence | subID ) + ( 1 | traits), data=longDf)
summary(m)

m<-lmer(scale(confidence) ~ scale(inDegree) + ( scale(inDegree) | subID ) + ( 1 | traits), data=longDf)
summary(m)
```

# Extreme Responses

```{r}
m<-lmer(scale(evalMid) ~ scale(confidence) + ( scale(confidence) | subID ) + ( 1 | traits), data=longDf)
summary(m)
r2glmm::r2beta(m)
```

```{r}
detach("package:lmerTest", unload=TRUE)
longDf$confidence.Z <- scale(longDf$confidence)
longDf$evalMid.Z <- scale(longDf$evalMid)
longDf$outDegree.Z <- scale(longDf$outDegree)
model.0 <- lmer(evalMid.Z ~ outDegree.Z + ( 1 | subID ) , data=longDf[!is.na(longDf$confidence),])
model.M <- lmer( confidence.Z ~ outDegree.Z + ( 1 | subID ) , data=longDf[!is.na(longDf$evalMid),])
model.Y <- lmer( evalMid.Z ~ confidence.Z + outDegree.Z + ( confidence.Z | subID ) , data=longDf)
library(mediation)
results <- mediate(model.M, model.Y, treat='outDegree.Z', mediator='confidence.Z',
                   boot=F, sims=500)
summary(results)
```

```{r}
longDf$confidence.Z <- scale(longDf$confidence)
longDf$evalMid.Z <- scale(longDf$evalMid)
longDf$outDegree.Z <- scale(longDf$outDegree)
model.0 <- lmer(evalMid.Z ~ outDegree.Z + ( 1 | subID ) , data=longDf[!is.na(longDf$confidence),])
model.M <- lmer( outDegree.Z ~ confidence.Z + ( confidence.Z | subID ) , data=longDf[!is.na(longDf$evalMid),])
model.Y <- lmer( evalMid.Z ~ confidence.Z + outDegree.Z + ( confidence.Z | subID ) , data=longDf)
library(mediation)
results <- mediate(model.M, model.Y, treat='confidence.Z', mediator='outDegree.Z',
                   boot=F, sims=500)
summary(results)
library(lmerTest)
```


# Manipulation

## Main Effect

```{r}
m<-lmer(scale(confidence) ~ COND + ( 1 | subID ) + ( 1 | traits), data=longDf)
summary(m)
ggpredict(m, c("COND")) %>% plot()
```

## Interactions

```{r}
m<-lmer(scale(confidence) ~ COND * scale(eval) + ( scale(eval) | subID ) + ( 1 | traits), data=longDf)
summary(m)
ggpredict(m, c("eval","COND")) %>% plot()

m<-lmer(scale(confidence) ~ COND * scale(evalMid) + ( scale(evalMid) | subID ) + ( 1 | traits), data=longDf)
summary(m)
ggpredict(m, c("evalMid","COND")) %>% plot()

m<-lmer(scale(confidence) ~ COND * scale(outDegree) + ( 1 | subID ) + ( COND | traits), data=longDf)
summary(m)
ggpredict(m, c("outDegree","COND")) %>% plot()

m<-lmer(scale(confidence) ~ COND * scale(inDegree) + ( 1 | subID ) + ( COND | traits), data=longDf)
summary(m)
ggpredict(m, c("outDegree","COND")) %>% plot()
```

# Individual Differences Predicting Confidence

```{r}
m<-lmer(scale(confidence) ~ scale(SCC) + ( 1 | subID ) + ( scale(SCC) | traits), data=longDf)
summary(m)

m<-lmer(scale(confidence) ~ scale(NFC) + ( 1 | subID ) + ( scale(NFC) | traits), data=longDf)
summary(m)

m<-lmer(scale(confidence) ~ scale(SE) + ( 1 | subID ) + ( scale(SE) | traits), data=longDf)
summary(m)

m<-lmer(scale(confidence) ~ scale(DS) + ( 1 | subID ) + ( scale(DS) | traits), data=longDf)
summary(m)

m<-lmer(scale(confidence) ~ scale(MAIA) + ( 1 | subID ) + ( scale(MAIA) | traits), data=longDf)
summary(m)

m<-lmer(scale(confidence) ~ scale(CESD) + ( 1 | subID ) + ( scale(CESD) | traits), data=longDf)
summary(m)
```

# Individual Differences Interacting with Valence in Predicting Confidence

```{r}
m<-lmer(scale(confidence) ~ scale(SCC) * valence + ( valence | subID ) + ( 1 | traits), data=longDf)
summary(m)

m<-lmer(scale(confidence) ~ scale(NFC) * valence + ( valence | subID ) + ( 1 | traits), data=longDf)
summary(m)

m<-lmer(scale(confidence) ~ scale(SE) * valence + ( valence | subID ) + ( 1 | traits), data=longDf)
summary(m)

m<-lmer(scale(confidence) ~ scale(DS) * valence + ( valence | subID ) + ( 1 | traits), data=longDf)
summary(m)

m<-lmer(scale(confidence) ~ scale(MAIA) * valence + ( valence | subID ) + ( 1 | traits), data=longDf)
summary(m)

m<-lmer(scale(confidence) ~ scale(CESD) * valence + ( valence | subID ) + ( 1 | traits), data=longDf)
summary(m)
```

```{r}
m<-lmer(scale(evalMid) ~ scale(SCC) * scale(confidence) + ( scale(confidence) | subID ) + ( 1 | traits), data=longDf)
summary(m)

m<-lmer(scale(evalMid) ~ scale(NFC) * scale(confidence) + ( scale(confidence) | subID ) + ( 1 | traits), data=longDf)
summary(m)

m<-lmer(scale(evalMid) ~ scale(SE) * scale(confidence) + ( scale(confidence) | subID ) + ( 1 | traits), data=longDf)
summary(m)

m<-lmer(scale(evalMid) ~ scale(DS) * scale(confidence) + ( scale(confidence) | subID ) + ( 1 | traits), data=longDf)
summary(m)

m<-lmer(scale(evalMid) ~ scale(MAIA) * scale(confidence) + ( scale(confidence) | subID ) + ( 1 | traits), data=longDf)
summary(m)

m<-lmer(scale(evalMid) ~ scale(CESD) * scale(confidence) + ( scale(confidence) | subID ) + ( 1 | traits), data=longDf)
summary(m)
```




```{r}
m<-lmer(scale(confidence) ~ COND * MAIA  + ( 1   | subID ) + ( COND | traits), data=longDf)
summary(m)
ggpredict(m, c("MAIA","COND")) %>% plot()
```

```{r}
m<-lmer(scale(confidence) ~ COND * valence  * scale(eval) + ( valence  + scale(eval)  | subID ) + ( COND | traits), data=longDf)
summary(m)
ggpredict(m, c("eval","valence","COND")) %>% plot()
```

```{r}
m<-lmer(scale(confidence) ~ COND*scale(eval) + scale(desirability) + scale(prevalence) + scale(observability) + ( scale(eval)  | subID ) + ( 1 | traits), data=longDf)
summary(m)
ggpredict(m, c("eval","COND")) %>% plot()
```


```{r}
m <- lm(scale(SCC) ~ COND, data = rawDf)
summary(m)
```


```{r}
m <- lm(scale(Race_Id) ~ COND, data = rawDf)
summary(m)

m <- lm(scale(Gender_Id) ~ COND, data = rawDf)
summary(m)

m <- lm(Sexual_Id ~ COND, data = rawDf)
summary(m)

m <- lm(Political_Id ~ COND, data = rawDf)
summary(m)

m <- lm(Student_Id ~ COND, data = rawDf)
summary(m)

table(rawDf$COND)
```

